library(DECIPHER)
library(msa)

setwd("~/Desktop/Final_Project/Datasets/Countries")

### download datasets from different countries 
france <- readDNAStringSet("SARS2-hum-France/ncbi_dataset/data/genomic.fna")
usa <- readDNAStringSet("SARS2-hum-USA/ncbi_dataset/data/genomic.fna")
china <- readDNAStringSet("SARS2-hum-China/ncbi_dataset/data/genomic.fna")
spain <- readDNAStringSet("SARS2-hum-Spain/ncbi_dataset/data/genomic.fna")
columbia <- readDNAStringSet("SARS2-hum-Columbia/ncbi_dataset/data/genomic.fna")
peru <- readDNAStringSet("SARS2-hum-Peru/ncbi_dataset/data/genomic.fna")
russia <- readDNAStringSet("SARS2-hum-Russia/ncbi_dataset/data/genomic.fna")
mexico <- readDNAStringSet("SARS2-hum-Mexico/ncbi_dataset/data/genomic.fna")
india <- readDNAStringSet("SARS2-hum-India/ncbi_dataset/data/genomic.fna")
italy <- readDNAStringSet("SARS2-hum-Italy/ncbi_dataset/data/genomic.fna")
brazil <- readDNAStringSet("SARS2-hum-Brazil/ncbi_dataset/data/genomic.fna")

### align sequences by country
france_consensus <- ConsensusSequence(france)
fileConn1 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/france_consensus.fasta"
writeXStringSet(france_consensus, fileConn1)


usa_consensus <- ConsensusSequence(usa)
fileConn2 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/usa_consensus.fasta"
writeXStringSet(usa_consensus, fileConn2)


china_consensus <- ConsensusSequence(china)
fileConn3 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/china_consensus.fasta"
writeXStringSet(china_consensus, fileConn3)


spain_consensus <- ConsensusSequence(spain)
fileConn4 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/spain_consensus.fasta"
writeXStringSet(spain_consensus, fileConn4)


columbia_consensus <- ConsensusSequence(columbia)
fileConn5 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/columbia_consensus.fasta"
writeXStringSet(columbia_consensus, fileConn5)


peru_consensus <- ConsensusSequence(peru)
fileConn6 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/peru_consensus.fasta"
writeXStringSet(peru_consensus, fileConn6)


russia_consensus <- ConsensusSequence(russia)
fileConn7 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/russia_consensus.fasta"
writeXStringSet(russia_consensus, fileConn7)


mexico_consensus <- ConsensusSequence(mexico)
fileConn8 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/mexico_consensus.fasta"
writeXStringSet(mexico_consensus, fileConn8)


italy_consensus <- ConsensusSequence(italy)
fileConn9 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/italy_consensus.fasta"
writeXStringSet(italy_consensus, fileConn9)


india_consensus <- ConsensusSequence(india)
fileConn10 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/india_consensus.fasta"
writeXStringSet(india_consensus, fileConn10)


brazil_consensus <- ConsensusSequence(brazil)
fileConn11 <- "~/Desktop/Final_Project/Datasets/Countries/Consensus/brazil_consensus.fasta"
writeXStringSet(brazil_consensus, fileConn11)


